<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>تسجيل دخول العملاء</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #f0f0f0;
      text-align: center;
      direction: rtl;
    }
    .login-box, .result-box {
      margin: 100px auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input {
      padding: 10px;
      width: 90%;
      margin: 10px 0;
    }
    button {
      padding: 10px 20px;
      background: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }
    .error {
      color: red;
      margin-top: 10px;
    }
    .data {
      text-align: right;
      margin-top: 20px;
      line-height: 2;
    }
  </style>
</head>
<body>
  <div class="login-box" id="loginBox">
    <h2>تسجيل الدخول</h2>
    <input type="text" id="user" placeholder="USER"><br>
    <input type="password" id="pass" placeholder="PASSWORD"><br>
    <button onclick="login()">دخول</button>
    <div class="error" id="error"></div>
  </div>

  <div class="result-box" id="resultBox" style="display:none;">
    <h2>بياناتك</h2>
    <div class="data" id="clientData"></div>
    <button onclick="logout()">تسجيل الخروج</button>
  </div>

  <script>
    const sheetID = "191fYruEVIITym8cgBKP4WuXg3dSCIrwS024sQClj1Ks";
    const sheetName = "Sheet1";
    const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

    let sheetData = [];

    fetch(url)
      .then(res => res.text())
      .then(data => {
        const jsonData = JSON.parse(data.substr(47).slice(0, -2));
        const rows = jsonData.table.rows;
        const headers = jsonData.table.cols.map(col => col.label);
        sheetData = rows.map(row => {
          const obj = {};
          row.c.forEach((cell, i) => {
            obj[headers[i]] = cell ? cell.v : "";
          });
          return obj;
        });
      });

    function login() {
      const user = document.getElementById("user").value.trim();
      const pass = document.getElementById("pass").value.trim();
      const error = document.getElementById("error");
      const resultBox = document.getElementById("resultBox");
      const loginBox = document.getElementById("loginBox");
      const clientData = document.getElementById("clientData");

      const client = sheetData.find(row => row.USER === user && row.PASSWORD === pass);

      if (client) {
        error.innerText = "";
        loginBox.style.display = "none";
        resultBox.style.display = "block";

        clientData.innerHTML = `
          رقم كارت المشاهدة: ${client['SmartCard']}<br>
          CLINT NAME: ${client['CLINT NAME']}<br>
          Dedicated Package: ${client['Dedicated Package']}<br>
          Your distributor: ${client['Your distributor']}<br>
          Issue Date: ${client['Issue Date']}<br>
          End Date: ${client['End Date']}<br>
          Amountpaid: ${client['Amountpaid']}<br>
          Additionalpurchasepackage: ${client['Additionalpurchasepackage']}<br>
          Paymentmethod: ${client['Paymentmethod']}<br>
          Costofservice: ${client['Costofservice']}<br>
          Totalpayment: ${client['Totalpayment']}
        `;
      } else {
        error.innerText = "USER أو PASSWORD غير صحيح.";
      }
    }

    function logout() {
      document.getElementById("loginBox").style.display = "block";
      document.getElementById("resultBox").style.display = "none";
      document.getElementById("user").value = "";
      document.getElementById("pass").value = "";
    }
  </script>
</body>
</html>
